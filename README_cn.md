# Cline 递归链式思维系统 (CRCT) - v7.5

欢迎使用 **Cline 递归链式思维系统 (CRCT)**，这是一个专为在 VS Code 中管理大型 Cline 项目中的上下文、依赖关系和任务而设计的框架。CRCT 基于递归的文件系统方法，结合模块化依赖跟踪系统，在项目复杂性增加时保持状态和效率。

版本 **v7.5** 标志着 CRCT 系统的一次重大重构，使其与最初的设计目标保持一致。随着核心架构的建立，未来的 v7.x 版本将专注于性能优化、功能增强和现有代码库的改进。

此版本包含更自动化的设计，整合了操作并提高了效率。
它还包括：
- 所有核心文件的基础模板
- 模块化依赖处理系统
- **上下文键 (KeyInfo)**：采用上下文键进行更精确和分层的依赖跟踪的根本性转变。
- **分层依赖聚合**：在主跟踪器中启用汇总依赖视图，更好地理解项目级别的依赖关系。
- **增强的 `show-dependencies` 命令**：提供了一种强大的方式来检查依赖关系，汇总给定键的所有跟踪器信息，简化依赖分析。
- **可配置嵌入设备**：允许用户通过 `.clinerules.config.json` 选择嵌入设备（`cpu`、`cuda`、`mps`）以优化性能。
- **文件排除模式**：用户现在可以通过 `.clinerules.config.json` 自定义项目分析，定义文件排除模式。
- **改进的缓存和批处理**：通过改进的缓存和批处理机制提升系统性能和效率。

**<<<重要通知>>>**

缓存已通过初步测试，并在整个系统中重新启用。如果您发现异常行为或不准确，请在 GitHub 问题部分报告。
- 如果出现问题，请**注释掉**（`#`）`@cached` 装饰器和相关的定义行（`# @cached(...)`）。

缓存 + 批处理可显著节省时间。
- **未启用**缓存和批处理的测试项目耗时约 `11` 分钟。
- **启用**缓存和批处理的测试项目耗时约 `30` 秒。

**<<<通知结束>>>**

---

## 主要功能

- **递归分解**：将任务分解为可管理的子任务，通过目录和文件组织以实现隔离的上下文管理。
- **最小化上下文加载**：仅加载必要数据，并根据需要通过依赖跟踪器扩展。
- **持久状态**：使用 VS Code 文件系统存储上下文、指令、输出和依赖关系，并通过 **强制更新协议 (MUP)** 保持最新。
- **模块化依赖系统**：完全模块化的依赖跟踪系统。
- **上下文键**：引入 `KeyInfo` 以实现上下文丰富的键，支持更准确和分层的依赖跟踪。
- **分层依赖聚合**：在主跟踪器中实现分层汇总和外部依赖聚合，提供更全面的项目依赖视图。
- **新 `show-dependencies` 命令**：LLM 不再需要手动读取和解析跟踪器文件。此参数将自动读取提供键的所有跟踪器，并返回入站和出站依赖关系以及每个相关文件的完整路径。（LLM 仍需手动替换占位符字符 'p'，但现在可以通过 `add-dependency` 命令轻松完成，从而大大简化了流程。）
- **可配置嵌入设备**：允许用户通过 `.clinerules.config.json` 配置嵌入设备（`cpu`、`cuda`、`mps`），以优化不同硬件上的性能。（注意：*系统尚未自动安装 cuda 或 mps 的依赖项，请手动安装或在 LLM 的帮助下完成安装。*）
- **文件排除模式**：用户现在可以在 `.clinerules.config.json` 中定义文件排除模式，以自定义项目分析。
- **新缓存系统**：实现了新的缓存机制以提高性能，包括改进的失效逻辑。
- **新批处理系统**：引入了批处理系统以高效处理大型任务，并增强了向处理函数传递参数的灵活性。
- **模块化依赖跟踪**：
  - 微型跟踪器（模块内的文件/函数级别）
  - 使用分层键和 RLE 压缩以提高效率。
- **自动化操作**：系统操作现已大部分自动化，并简化为单一命令，优化工作流程并减少手动命令执行。
- **基于阶段的工作流**：在 **设置/维护**、**策略**、**执行** 等不同阶段运行，由 `.clinerules` 控制。
- **链式思维推理**：通过逐步推理和反思确保透明性。

---

## 快速开始

1. **克隆仓库**：
   ```bash
   git clone https://github.com/RPG-fan/Cline-Recursive-Chain-of-Thought-System-CRCT-.git
   cd Cline-Recursive-Chain-of-Thought-System-CRCT-
   ```

2. **安装依赖**：
   ```bash
   pip install -r requirements.txt
   ```

3. **设置 Cline 扩展**：
   - 在安装了 Cline 扩展的 VS Code 中打开项目。
   - 将 `cline_docs/prompts/core_prompt(put this in Custom Instructions).md` 复制到 Cline 系统提示字段中。

4. **启动系统**：
   - 在 Cline 输入框中输入 `Start.` 初始化系统。
   - LLM 将从 `.clinerules` 引导，创建缺失文件并在需要时指导您完成设置。

*注意*：Cline 扩展的 LLM 会自动化大部分命令和对 `cline_docs/` 的更新。理论上需要的用户干预最少！

---

## 项目结构

```
Cline-Recursive-Chain-of-Thought-System-CRCT-/
│   .clinerules
│   .gitignore
│   INSTRUCTIONS.md
│   LICENSE
│   README.md
│   requirements.txt
│
├───cline_docs/                   # 操作内存
│   │  activeContext.md           # 当前状态和优先级
│   │  changelog.md               # 记录重大更改
│   │  userProfile.md             # 用户配置文件和偏好
│   ├──backups/                   # 跟踪器文件的备份
│   ├──prompts/                   # 系统提示和插件
│   │    core_prompt.md           # 核心系统指令
│   │    execution_plugin.md
│   │    setup_maintenance_plugin.md
│   │    strategy_plugin.md
│   ├──templates/                 # HDTA 文档模板
│   │    implementation_plan_template.md
│   │    module_template.md
│   │    system_manifest_template.md
│   │    task_template.md
│
├───cline_utils/                  # 工具脚本
│   └─dependency_system/
│     │ dependency_processor.py   # 依赖管理脚本
│     ├──analysis/                # 分析模块
│     ├──core/                    # 核心模块
│     ├──io/                      # IO 模块
│     └──utils/                   # 工具模块
│
├───docs/                         # 项目文档
└───src/                          # 源代码根目录

```

---

## 当前状态与未来计划

- **v7.5**：此版本标志着 CRCT 系统的一次重大重构，使其与最初的设计目标保持一致。**关键架构更改包括引入上下文键 (`KeyInfo`) 和分层依赖聚合，增强了依赖跟踪的精确性和可扩展性。** 主要功能还包括新 `show-dependencies` 命令以简化依赖检查、可配置嵌入设备和文件排除模式。
- **效率**：在依赖跟踪中实现了约 1.9 的效率比（字符数减少 90%），并且在更大规模下效率更高。
- **小型项目与依赖存储的节省**：版本 7.5 增强了依赖存储，并将效率优势扩展到小型项目，提高了 CRCT 的多功能性。
- **自动化设计**：系统操作大部分自动化，将大多数流程简化为单一命令（如 `analyze-project`），优化了工作流程。
- **未来重点**：随着 v7.5 核心架构的建立，未来开发将集中于性能优化、对新 `show-dependencies` 命令的增强以及现有功能的改进。**具体而言，未来的 v7.x 版本将专注于性能优化、功能增强和代码库的精炼。**

欢迎反馈！请通过 GitHub Issues 报告错误或提出建议。

---

## 入门指南（可选 - 现有项目）

要在现有项目上进行测试：
1. 将您的项目复制到 `src/`。
2. 使用以下提示启动 LLM：
   - `执行初始设置并填充依赖跟踪器。`
   - `审查当前状态并建议下一步操作。`

系统将分析您的代码库，初始化跟踪器，并引导您前进。

---

## 感谢！

这是为了让 Cline 项目更易于管理的一项热爱之作。我很想听听您的想法——试试看并告诉我哪些有效（或无效）！
